!function(){var t,e,n=document.querySelector(".game-field"),a=document.querySelector(".game-score"),i=document.querySelector(".message-start"),r=document.querySelector(".message-lose"),s=document.querySelector(".message-win"),o=document.querySelector(".button"),l=Array.from({length:n.tBodies[0].rows.length},function(){return Array(n.tBodies[0].rows[0].cells.length).fill(0)}),c={};function u(t,e,n){if(!e.has(t))throw TypeError("attempted to get private field on non-instance");return n}function h(t,e){!function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}(t,e),e.add(t)}function f(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=Array(e);n<e;n++)a[n]=t[n];return a}function d(t){return function(t){if(Array.isArray(t))return f(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return f(t,void 0);var n=Object.prototype.toString.call(t).slice(8,-1);if("Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return f(t,void 0)}}(t)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var v=/*#__PURE__*/new WeakSet,m=/*#__PURE__*/new WeakSet,S=/*#__PURE__*/new WeakSet,g=/*#__PURE__*/new WeakSet,y=/*#__PURE__*/new WeakSet,w=/*#__PURE__*/new WeakSet,p=/*#__PURE__*/new WeakSet,T=/*#__PURE__*/new WeakSet,k=/*#__PURE__*/new WeakSet,b=/*#__PURE__*/function(){var t;function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],n=arguments.length>1?arguments[1]:void 0,a=arguments.length>2?arguments[2]:void 0;!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,e),h(this,v),h(this,m),h(this,S),h(this,g),h(this,y),h(this,w),h(this,p),h(this,T),h(this,k),this.initialState=t,this.state=t.map(function(t){return d(t)}),this.status=e.STATUSES.idle,this.score=0,this.gameBoard=n,this.scoreField=a}return t=[{key:"getScore",value:function(){return this.score}},{key:"getState",value:function(){return this.state}},{key:"getStatus",value:function(){return this.status}},{key:"start",value:function(){this.status=e.STATUSES.playing,u(this,v,A).call(this),u(this,v,A).call(this)}},{key:"restart",value:function(){this.state=this.initialState.map(function(t){return d(t)}),this.status=e.STATUSES.idle,this.score=0}},{key:"moveLeft",value:function(){var t=this;if(this.status===e.STATUSES.playing){var n=!1;this.state=this.state.map(function(e){return u(t,k,M).call(t,e)?(n=!0,u(t,y,B).call(t,e)):e}),n&&u(this,v,A).call(this),u(this,w,W).call(this)}}},{key:"moveRight",value:function(){var t=this;if(this.status===e.STATUSES.playing){var n=!1;this.state=this.state.map(function(e){var a=d(e).reverse();return u(t,k,M).call(t,a)?(n=!0,u(t,y,B).call(t,a).reverse()):e}),n&&u(this,v,A).call(this),u(this,w,W).call(this)}}},{key:"moveUp",value:function(){var t=this;if(this.status===e.STATUSES.playing){var n=!1,a=u(this,g,U).call(this,this.state).map(function(e){return u(t,k,M).call(t,e)?(n=!0,u(t,y,B).call(t,e)):e});this.state=u(this,g,U).call(this,a),n&&u(this,v,A).call(this),u(this,w,W).call(this)}}},{key:"moveDown",value:function(){var t=this;if(this.status===e.STATUSES.playing){var n=!1,a=u(this,g,U).call(this,this.state).map(function(e){var a=d(e).reverse();return u(t,k,M).call(t,a)?(n=!0,u(t,y,B).call(t,a).reverse()):e});this.state=u(this,g,U).call(this,a),n&&u(this,v,A).call(this),u(this,w,W).call(this)}}},{key:"updateGameBoard",value:function(){var t=/field-cell--\d+/,e=this.getState();this.scoreField.innerText=this.getScore();for(var n=0;n<e.length;n++)for(var a=0;a<e.length;a++)0!==e[n][a]?(this.gameBoard.rows[n].cells[a].className="field-cell field-cell--".concat(e[n][a]),this.gameBoard.rows[n].cells[a].innerText=e[n][a]):0===e[n][a]&&t.test(this.gameBoard.rows[n].cells[a].className)&&(this.gameBoard.rows[n].cells[a].className="field-cell",this.gameBoard.rows[n].cells[a].innerText="")}}],function(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}(e.prototype,t),e}();function A(){var t=u(this,S,L).call(this);null!==t&&(this.state[t[0]][t[1]]=.9>Math.random()?2:4)}function E(){for(var t=[],e=0;e<this.state.length;e++)for(var n=0;n<this.state[0].length;n++)0===this.state[e][n]&&t.push([e,n]);return t}function L(){var t=u(this,m,E).call(this);if(t.length<1)return null;var e=Math.floor(Math.random()*t.length);return t[e]}function U(t){return t[0].map(function(e,n){return t.map(function(t){return t[n]})})}function B(t){for(var e=[0,0,0,0],n=1;n<t.length;n++)if(0!==t[n]){for(var a=n,i=null,r=n-1;r>=0&&(0===t[r]||t[r]===t[a]&&1!==e[r]);)i=r,r--;null!==i&&(0===t[i]?(t[i]=t[a],t[a]=0):(t[i]+=t[a],t[a]=0,e[i]=1,this.score+=t[i]))}return t}function W(){u(this,T,q).call(this)||(this.status=b.STATUSES.lose),u(this,p,j).call(this)&&(this.status=b.STATUSES.win)}function j(){return this.state.some(function(t){return t.some(function(t){return 2048===t})})}function q(){var t=this;if(u(this,m,E).call(this).length>=1)return!0;var e=this.state.some(function(e){var n=d(e);return!!(u(t,k,M).call(t,e)||u(t,k,M).call(t,n))}),n=u(this,g,U).call(this,this.state).some(function(e){var n=d(e);return!!(u(t,k,M).call(t,e)||u(t,k,M).call(t,n))});return e||n}function M(t){return t.some(function(e,n){return 0!==n&&0!==e&&(0===t[n-1]||t[n]===t[n-1])})}e={idle:"idle",playing:"playing",win:"win",lose:"lose"},(t="STATUSES")in b?Object.defineProperty(b,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):b[t]=e;var x=new(c=b)(l,n.tBodies[0],a);function R(){var t,e,n,a;window.addEventListener("keydown",D,{once:!0}),t=0,e=0,n=0,a=0,window.addEventListener("touchstart",function(n){t=n.touches[0].clientX,e=n.touches[0].clientY},{once:!0}),window.addEventListener("touchend",function(i){var r,s;n=i.changedTouches[0].clientX,a=i.changedTouches[0].clientY,Math.abs(r=n-t)>Math.abs(s=a-e)?r>50?x.moveRight():r<-50&&x.moveLeft():s>50?x.moveDown():s<-50&&x.moveUp(),O()},{once:!0})}function D(t){switch(t.key){case"ArrowDown":x.moveDown();break;case"ArrowUp":x.moveUp();break;case"ArrowLeft":x.moveLeft();break;case"ArrowRight":x.moveRight();break;default:R();return}O()}function O(){x.updateGameBoard();var t=x.getStatus();t===c.STATUSES.win&&s.classList.remove("hidden"),t===c.STATUSES.lose&&r.classList.remove("hidden"),R()}o.addEventListener("click",function(){o.classList.contains("start")?(x.start(),o.classList.remove("start"),o.classList.add("restart"),o.innerText="Restart",i.classList.add("hidden")):o.classList.contains("restart")&&(x.restart(),o.classList.remove("restart"),o.classList.add("start"),o.innerText="Start",i.classList.remove("hidden"),s.classList.add("hidden"),r.classList.add("hidden")),x.updateGameBoard()}),R()}();
//# sourceMappingURL=index.f7e3b843.js.map
